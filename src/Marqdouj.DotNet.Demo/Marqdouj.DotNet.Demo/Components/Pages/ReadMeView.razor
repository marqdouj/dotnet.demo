@using Markdig
@inject HttpClient Http

<FluentCard MinimalStyle="true" Style="@height">
    <div class="markdown-body" style="overflow-y:auto;height:100%;width:100%;padding:10px;">
        @((MarkupString)htmlContent)
    </div>
</FluentCard>

@code {
    private string htmlContent = "";
    private string projectUrl => $"https://github.com/marqdouj/{Repository}";
    private string height => string.IsNullOrWhiteSpace(Height) ? "height:90%" : $"height:{Height}";

    [Parameter]
    public string? Height { get; set; }

    [Parameter, EditorRequired] public string Repository { get; set; } = string.Empty;

    protected override async Task OnInitializedAsync()
    {
        if (!string.IsNullOrEmpty(Repository))
        {
            var pipeline = new MarkdownPipelineBuilder().UseAdvancedExtensions().Build();
            var url = $"https://raw.githubusercontent.com/marqdouj/{Repository}/master/README.md";
            var markdownContent = await Http.GetStringAsync(url);
            htmlContent = Markdown.ToHtml(markdownContent, pipeline);
        }
    }
}
